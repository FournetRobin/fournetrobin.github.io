
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Geo Quizz</title>
    <style>
        body {
            margin: 0;
            background-color: black;
            overflow: hidden;
        }
        h1, p, a {
            color: white;
            font-family: Arial, Helvetica, sans-serif;
        }
        a {
            color: darkorange;
        }
    </style>
</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <h1>Geo_Quizz : Quel est le pays affiché sur la terre ?</h1>
    <input type="text" id="monpays">
    <input type="button" value="Valider" onclick="validerPays()">
    <a href="./ProjetCartoGeo.html">Trouve_Pays</a>
    <p id="erreur"></p>

    <script>
        let namePays = "";

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(2, 0, 5);

        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        const controls = new THREE.OrbitControls(camera, renderer.domElement);

        const geometry = new THREE.SphereGeometry(3, 32, 32);
        const material = new THREE.MeshPhongMaterial({
            map: new THREE.TextureLoader().load('8081_earthmap4k.jpg'),
            bumpMap: new THREE.TextureLoader().load('8081_earthbump4k.jpg'),
            bumpScale: 0.25,
            specularMap: new THREE.TextureLoader().load('8081_earthspec4k.jpg'),
            specular: new THREE.Color('grey')
        });

        const sphere = new THREE.Mesh(geometry, material);
        scene.add(sphere);

        const light = new THREE.AmbientLight(0x404040, 3);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
        directionalLight.position.set(5, 5, 5);
        scene.add(directionalLight, light);

        function latlontexture(lat, long, textu) {
            lat = lat * Math.PI / 180;
            long = -long * Math.PI / 180;
            const X = 3 * Math.cos(lat) * Math.cos(long);
            const Z = 3 * Math.cos(lat) * Math.sin(long);
            const Y = 3 * Math.sin(lat);
            const textureA = new THREE.TextureLoader().load(textu);

            const geometry = new THREE.BoxGeometry(0.2, 0.2, 0.2);
            const material = new THREE.MeshBasicMaterial({ map: textureA });
            const cube = new THREE.Mesh(geometry, material);
            cube.position.set(X, Y, Z);
            scene.add(cube);
        }

        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }
        animate();

        function randomIntFromInterval(min, max) {
            return Math.floor(Math.random() * (max - min + 1) + min);
        }

        $.ajax({
            url: 'https://restcountries.com/v3.1/all',
            type: 'GET',
            dataType: 'json',
            success: function (data) {
                document.getElementById("erreur").innerHTML = "";
                const randindex = randomIntFromInterval(0, data.length - 1);
                const country = data[randindex];
                latlontexture(country.latlng[0], country.latlng[1], country.flags.png);
                namePays = country.name.common;
                console.log(namePays);
            },
            error: function () {
                console.log("Erreur lors du chargement des données pays.");
                document.getElementById("erreur").innerHTML = "ERREUR !!!";
            }
        });

        function validerPays() {
            const pays = document.getElementById('monpays').value;
            if (pays.toLowerCase() === namePays.toLowerCase()) {
                document.getElementById("erreur").innerHTML = "Bravo vous avez trouvé le bon pays !!!";
            } else {
                document.getElementById("erreur").innerHTML = "Perdu ... le pays était " + namePays;
            }
            setTimeout(() => location.reload(), 5000);
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
